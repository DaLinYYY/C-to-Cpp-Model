<!--
 * @FileName: 
 * @Author: YangSL
 * @Date: 2022-03-01 18:08:05
 * @LastEditTime: 2022-03-01 18:14:30
 * @Description: 
-->
# 用C语言实现面向对象编程

GOF的《设计模式》一书的副标题叫做“可复用面向对象软件的基础”，从标题就能看出面向对象是设计模式基本思想。由于C语言并不是面向对象的语言，C语言没有直接提供封装、继承、组合、多态等面向对象的功能，但C语言有struct和函数指针。我们可以用struct中的数据和函数指针，以此来模拟对象和类的行为。

---

## 1. 封装
封装是指对象仅暴露必要的对外接口（这里指public方法）来和其它对象进行交互，其它的属性和行为都无需暴露，这使得对象的内部实现可以自由修改。这也要求对象包含它能进行操作所需要的所有信息，不必依赖其它对象来完成自己的操作。

以下以电力公司的例子演示封装。

电力公司生产并提供电力。为了汇聚各种发电厂的电力并让用户获得电力，电力公司提供了两个统一接口：1、电力公司汇聚各种发电厂的电力，无论是火力发电厂、水力发电厂、原子能发电厂等都使用一个接口。如果什么时候一家火力发电厂改造成了风力发电厂，发电厂的实现完全不一样了，但接口不变，所以电力公司感觉不到发电厂变了，不需要为了发电厂实现升级而改造电力公司的系统。2、电力公司向用户提供电力，无论用户用电的设备是烤面包机还是洗衣机，电力公司和用户之间都使用一个接口（电源插座）。用户的用电设备可以千变万化，但接口（电源插座）不变。所以电力公司不用关系用户的什么设备在用电。


## 2. 继承
面向对象编程最强大的功能之一就是代码重用，而继承就是实现代码重用的主要手段之一。
继承允许一个类继承另一个类的属性和方法。我们可以通过识别事物之间的共性，通过抽象公共属性和行为来构造父类，而通过继承父类来构造各子类。父类，即公共属性和行为，就得到了复用。

以下哺乳动物的例子演示继承。

猫和狗都是哺乳动物，它们具有公共的属性和行为。比如，猫和狗都有眼睛，且它们都会叫。我们把眼睛的颜色、会叫抽象出来，作为哺乳动物父类的属性，让猫类、狗类都继承哺乳动物父类，可实现对”眼睛的颜色“、”会叫“实现的复用。


## 3. 多态
多态与继承是紧耦合的关系，但它通常作为面向对象技术中最强大的优点之一。子类从继承父类的接口，每个子类是单独的实体，每个子类需要对同一消息有单独的应答。每个子类对同一消息的应答采用继承的相同接口，但每个子类可以有不同的实现，这就是多态。

在猫和狗的例子中，猫类、狗类都继承了哺乳动物父类的“叫”的方法，但猫类、狗类的叫声并不一样，所以猫类、狗类可以采用不同的“叫”的实现。


## 4. 组合
组合与继承都是面向对象中代码复用的方式，也只有通过组合和继承两种方式能够实现使用其他类构建新类。

在前面讲的继承关系中，我们把通用属性和行为抽象出来作为父类。例如：猫、狗都是哺乳动物，它们具有哺乳动物通用的属性和行为。猫、狗与哺乳动物的关系是“is-a”，即猫、狗（is-a）哺乳动物。
而组合关系体现的是“has-a”。以房子和窗户的关系举例。我们可以单独构建窗户类，然后把窗户类应用到各种房子类上。此时房子（has-a）窗户，但绝不是窗户（is-a）房子。


**组合和继承的区别有以下几点**

组合关系体现的是“has-a”。继承关系体现的是“is-a”。

组合是“黑箱”复用，通过获得其它对象的引用而在“运行时”动态定义。继承是“白箱”复用，“编译时”静态定义。

这点非常非常的重要，后续讲到具体设计模式时，经常会使用“运行时”动态定义替代“编译时”静态定义方式来实现






